# Migrations

These migrations are generated by Atlas based on the declarative schema in
`migrations`.

## Setup

```bash
brew install atlas
```

## After making a manual change to the migrations

actually it's going to be:

1. edit migrations in supabase/migrations
2. let supabase recreate the db locally
3. generate the migration files in atlas/migrations_deploy ... do this before
   deployment; no need for local work
4. apply them

From this directory:

```bash
atlas migrate hash --dir "file://migrations"
```

Apply locally:

```bash
atlas migrate apply --dir "file://migrations" --url "postgresql://postgres:postgres@127.0.0.1:54322/postgres?search_path=public&sslmode=disable"
```

TODO: When we apply to production, generate migration files and commit them.
